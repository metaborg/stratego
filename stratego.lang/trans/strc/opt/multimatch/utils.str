module multimatch/utils

strategies
  zipn = zipn(id)
  zipn(s) = genzip(ZipN1, ZipN2, ZipN3, s)
  
  ZipN1 = tmap(?[]); ![]
  ZipN2 = !(<tmap(Hd)>, <tmap(Tl)>)
  ZipN3 = Zip3

  /*
   * Takes elements from the start of the list, including the first element at
   * which `s` succeeds. Drops all subsequent elements.
   */
  drop-after(s) =
    split-fetch-keep(s) => (x1*, x2, _)
  ; <at-end(!x2)> x1*