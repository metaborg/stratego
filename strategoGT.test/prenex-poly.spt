module prenex-poly

language strategoGT

fixture [[
  specification

  rules
  [[...]]
]]

test untyped map [[
    map(s) = [s | map(s)] <+ ?[]

    test-map :: ? -> List(str)
    test-map = ![1,2,3]; map(!"hi!")
]] 0 errors
   0 warnings
   has origin locations

test typed map [[
    map(a -> b) :: List(a) -> List(b)
    map(s) = [s | map(s)] <+ ?[]

    test-map :: ? -> List(str)
    test-map = ![1,2,3]; map(!"hi!")
    // `map`'s type is ideally instantiated as `(int -> str) List(int) -> List(str)`
    // but `(? -> str) List(?) -> List(str)` is also possible, since `!"hi!" :: ? -> str` by itself
]] 0 errors
   0 warnings
//   has origin locations

test untyped collect-all [[
    collect-all(s) = ?t@_#(<id>); mapconcat(collect-all(s)); (![<s> t | <id>] <+ id)

    test-collect-all :: ? -> List(str)
    test-collect-all = ![1,2,3]; collect-all(!"hi!")
]] 0 errors
   0 warnings
   has origin locations

test typed collect-all [[
    collect-all(? -> b) :: ? -> List(b)
    collect-all(s) = ?t@_#(<id>); mapconcat(collect-all(s)); (![<s> t | <id>] <+ id)

    test-collect-all :: ? -> List(str)
    test-collect-all = ![1,2,3]; collect-all(!"hi!")
]] 0 errors
   0 warnings
   has origin locations
