module dynamic-rules

imports

libstratego-lib

signature constructors
  Int : str -> Expr
  Bar : str * str -> Expr

rules

// TODO: allow type definition for dynamic rules
Foo :: int -> int

main :: str -> int
main = ?a; {| Foo:
    rules(Foo: Bar(a, b) -> <foo> (a, b))
//             ^ expected int but got Expr
  ; desugar
  ; (<fail> a -> <foo> a)
|}

foo = fail

//desugar :: Expr -> Expr
desugar: Int(i) -> Int(<Foo> i)


